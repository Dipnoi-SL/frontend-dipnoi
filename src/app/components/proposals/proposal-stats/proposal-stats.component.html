<div class="dialog-side-content">
  <div class="vertical-card">
    <h4>Details</h4>
    <div class="box-row">
      <p class="p-category">Title</p>
      <ng-container *ngIf="{ data: userService.authUser$ | async } as authUser">
        <p class="p-value">
          {{ proposal.getCurrentTitle(authUser.data) }}
        </p>
      </ng-container>
    </div>
    <div class="box-row">
      <p class="p-category">Author</p>
      <p class="p-value">
        {{ proposal.user.nickname }}
      </p>
    </div>
    <div class="box-row">
      <p class="p-category">Labels</p>
      <p class="p-value">
        {{ proposal.categories.join(', ') }}
      </p>
    </div>
  </div>
  <div
    *ngIf="proposal.isSelectedForDevelopment || proposal.isInDevelopment"
    class="vertical-card"
  >
    <h4>Priority</h4>

    <div class="box-row row-icon">
      <div class="icon-container icon-container-priority">
        <img
          class="image"
          src="../../../assets/icons/prio-5.svg"
          name="matAccessibleForwardOutline"
          (click)="onImportanceVote(5)"
        />
      </div>

      <div class="icon-container icon-container-priority">
        <img
          class="image"
          src="../../../assets/icons/prio-4.svg"
          name="matAccessibleForwardOutline"
          (click)="onImportanceVote(4)"
        />
      </div>

      <div class="icon-container icon-container-priority">
        <img
          class="image"
          src="../../../assets/icons/prio-3.svg"
          name="matAccessibleForwardOutline"
          (click)="onImportanceVote(3)"
        />
      </div>

      <div class="icon-container icon-container-priority">
        <img
          class="image"
          src="../../../assets/icons/prio-2.svg"
          name="matAccessibleForwardOutline"
          (click)="onImportanceVote(2)"
        />
      </div>

      <div class="icon-container icon-container-priority">
        <img
          class="image"
          src="../../../assets/icons/prio-1.svg"
          name="matAccessibleForwardOutline"
          (click)="onImportanceVote(1)"
        />
      </div>
    </div>
    <div class="box-row">
      <p class="p-category">Votes</p>

      <p class="p-value">
        {{ proposal.importanceWeightsSum }}
      </p>
    </div>
    <div class="box-row">
      <p class="p-category">Average</p>
      <div class="value-icon">
        <p class="p-value">{{ proposal.importance }}</p>
        <img class="image" src="../../../assets/icons/prio-1.svg" />
      </div>
    </div>
  </div>
  <ng-container
    *ngIf="
      (pollService.finalPoll$ | async) ??
      (pollService.initialPoll$ | async) as currentPoll
    "
  >
    <div class="vertical-card">
      <h4>Backing</h4>
      <div class="box-row bar-row">
        <div class="icon-container adjustment-vector-up">
          <img
            class="image"
            src="../../../assets/icons/vector-up.svg"
            name="matAccessibleForwardOutline"
            (click)="onInterestVote(true, currentPoll)"
          />
        </div>
        <div class="bar">
          <div
            class="bar-fill"
            [ngStyle]="{
              width: currentPoll.positiveRatio + '%'
            }"
          ></div>
        </div>
        <div class="icon-container adjustment-vector-down">
          <img
            class="image"
            src="../../../assets/icons/vector-down.svg"
            name="matAccessibleForwardOutline"
            (click)="onInterestVote(true, currentPoll)"
          />
        </div>
      </div>
      <div class="box-row">
        <p class="p-category">Votes</p>
        <div class="box-column">
          <div class="value-icon">
            <p class="p-value">
              {{ currentPoll.positiveValue }}
            </p>
            <img class="image" src="../../../assets/icons/vector-up.svg" />
          </div>
          <div class="value-icon">
            <p class="p-value">
              {{ currentPoll.negativeValue }}
            </p>
            <img class="image" src="../../../assets/icons/vector-down.svg" />
          </div>
        </div>
      </div>
      <div class="box-row">
        <p class="p-category">Balance</p>
        <div class="value-icon">
          <p class="p-value">
            {{ currentPoll.positiveValue - currentPoll.negativeValue }}
          </p>
          <img class="image" src="../../../assets/icons/vector-up.svg" />
        </div>
      </div>
      <div class="box-row">
        <p class="p-category">Ratio</p>
        <p class="p-value">{{ currentPoll.positiveRatio }}%</p>
      </div>
    </div>
  </ng-container>
  <div class="vertical-card">
    <h4>Status</h4>
    <div class="box-row">
      <p class="p-category">Stage</p>
      <p class="p-value">
        {{ proposal.state }}
      </p>
    </div>
    <div *ngIf="proposal.isNotBacked || proposal.isNotViable" class="box-row">
      <p class="p-category">Motive</p>
      <p class="p-value">
        {{ proposal.state }}
      </p>
    </div>
    <div *ngIf="proposal.cost" class="box-row">
      <p class="p-category">Cost</p>
      <p class="p-value">
        {{ proposal.cost }}
      </p>
    </div>
    <div class="box-row">
      <p class="p-category">Releases</p>
      <div class="box-column">
        <p class="p-value">Created {{ proposal.formattedCreatedAt }}</p>
        <p class="p-value" *ngIf="proposal.resetAt">
          Opened {{ proposal.formattedResetAt }}
        </p>
        <p class="p-value" *ngIf="proposal.selectedAt">
          Selected {{ proposal.formattedSelectedAt }}
        </p>
        <p class="p-value" *ngIf="proposal.disregardedAt">
          Archived {{ proposal.formattedDisregardedAt }}
        </p>
        <p class="p-value" *ngIf="proposal.completedAt">
          Implemented {{ proposal.formattedCompletedAt }}
        </p>
      </div>
    </div>
  </div>
</div>
