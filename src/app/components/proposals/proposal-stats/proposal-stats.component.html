<div class="dialog-side-content">
  <div class="vertical-card">
    <h4>Details</h4>
    <div class="box-row">
      <p class="p-category">Title</p>
      <ng-container *ngIf="{ data: userService.authUser$ | async } as authUser">
        <p class="p-value">
          {{ proposal.getCurrentTitle(authUser.data) }}
        </p>
      </ng-container>
    </div>
    <div class="box-row">
      <p class="p-category">Author</p>
      <p class="p-value">
        {{ proposal.user.nickname }}
      </p>
    </div>
    <div class="box-row">
      <p class="p-category">Labels</p>
      <p class="p-value">
        {{ proposal.categories.join(', ') }}
      </p>
    </div>
  </div>
  <div
    *ngIf="proposal.isSelectedForDevelopment || proposal.isInDevelopment"
    class="vertical-card"
  >
    <h4>Priority</h4>
    <div class="box-row">
      <ng-icon
        name="matAccessibleForwardOutline"
        (click)="onImportanceVote(1)"
      ></ng-icon>
      <ng-icon
        name="matAccessibleForwardOutline"
        (click)="onImportanceVote(2)"
      ></ng-icon>
      <ng-icon
        name="matAccessibleForwardOutline"
        (click)="onImportanceVote(3)"
      ></ng-icon>
      <ng-icon
        name="matAccessibleForwardOutline"
        (click)="onImportanceVote(4)"
      ></ng-icon>
      <ng-icon
        name="matAccessibleForwardOutline"
        (click)="onImportanceVote(5)"
      ></ng-icon>
    </div>
    <div class="box-row">
      <p class="p-category">Votes</p>
      <p class="p-value">
        {{ proposal.importanceWeightsSum }}
      </p>
    </div>
    <div class="box-row">
      <p class="p-category">Average</p>
      <p class="p-value">{{ proposal.importance }}</p>
    </div>
  </div>
  <ng-container
    *ngIf="
      (pollService.finalPoll$ | async) ??
      (pollService.initialPoll$ | async) as currentPoll
    "
  >
    <div class="vertical-card">
      <h4>Backing</h4>
      <div class="box-row">
        <ng-icon
          name="matAccessibleForwardOutline"
          (click)="onInterestVote(false, currentPoll)"
        ></ng-icon>
        <div class="bar">
          <div
            class="bar-fill"
            [ngStyle]="{
              width: currentPoll.positiveRatio + '%'
            }"
          ></div>
        </div>
        <ng-icon
          name="matAccessibleForwardOutline"
          (click)="onInterestVote(true, currentPoll)"
        ></ng-icon>
      </div>
      <div class="box-row">
        <p class="p-category">Votes</p>
        <div class="box-column">
          <p class="p-value">
            {{ currentPoll.positiveValue }}
          </p>
          <p class="p-value">
            {{ currentPoll.negativeValue }}
          </p>
        </div>
      </div>
      <div class="box-row">
        <p class="p-category">Balance</p>
        <p class="p-value">
          {{ currentPoll.positiveValue - currentPoll.negativeValue }}
        </p>
      </div>
      <div class="box-row">
        <p class="p-category">Ratio</p>
        <p class="p-value">{{ currentPoll.positiveRatio }}%</p>
      </div>
    </div>
  </ng-container>
  <div class="vertical-card">
    <h4>Status</h4>
    <div class="box-row">
      <p class="p-category">Stage</p>
      <p class="p-value">
        {{ proposal.state }}
      </p>
    </div>
    <div *ngIf="proposal.isNotBacked || proposal.isNotViable" class="box-row">
      <p class="p-category">Motive</p>
      <p class="p-value">
        {{ proposal.state }}
      </p>
    </div>
    <div *ngIf="proposal.cost" class="box-row">
      <p class="p-category">Cost</p>
      <p class="p-value">
        {{ proposal.cost }}
      </p>
    </div>
    <div class="box-row">
      <p class="p-category">Releases</p>
      <div class="box-column">
        <p class="p-value">Created {{ proposal.formattedCreatedAt }}</p>
        <p class="p-value" *ngIf="proposal.resetAt">
          Opened {{ proposal.formattedResetAt }}
        </p>
        <p class="p-value" *ngIf="proposal.selectedAt">
          Selected {{ proposal.formattedSelectedAt }}
        </p>
        <p class="p-value" *ngIf="proposal.disregardedAt">
          Archived {{ proposal.formattedDisregardedAt }}
        </p>
        <p class="p-value" *ngIf="proposal.completedAt">
          Implemented {{ proposal.formattedCompletedAt }}
        </p>
      </div>
    </div>
  </div>
</div>
